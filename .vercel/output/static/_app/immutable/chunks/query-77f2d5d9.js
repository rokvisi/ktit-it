import{i as X,f as Y,r as Z,n as v,t as $,e as ee,g as B,R as k,a as A,b as W,c as d,S as L,h as V,p as P,m as K,d as R,j as H,k as S,o as U,l as x,q as D,s as G}from"./logger-312c5320.js";import"./preload-helper-aa6bc0ce.js";import"./index-055277d2.js";class te{constructor(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}setOptions(e){var t;this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.meta=e==null?void 0:e.meta,this.cacheTime=Math.max(this.cacheTime||0,(t=this.options.cacheTime)!==null&&t!==void 0?t:5*60*1e3)}setDefaultOptions(e){this.defaultOptions=e}scheduleGc(){this.clearGcTimeout(),X(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}clearGcTimeout(){clearTimeout(this.gcTimeout),this.gcTimeout=void 0}optionalRemove(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))}setData(e,t){var i,s;const a=this.state.data;let r=Y(e,a);return!((s=(i=this.options).isDataEqual)===null||s===void 0)&&s.call(i,a,r)?r=a:this.options.structuralSharing!==!1&&(r=Z(a,r)),this.dispatch({data:r,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt}),r}setState(e,t){this.dispatch({type:"setState",state:e,setStateOptions:t})}cancel(e){var t;const i=this.promise;return(t=this.retryer)===null||t===void 0||t.cancel(e),i?i.then(v).catch(v):Promise.resolve()}destroy(){this.clearGcTimeout(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(e=>e.options.enabled!==!1)}isFetching(){return this.state.isFetching}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!$(this.state.dataUpdatedAt,e)}onFocus(){var e;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t&&t.refetch(),(e=this.retryer)===null||e===void 0||e.continue()}onOnline(){var e;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t&&t.refetch(),(e=this.retryer)===null||e===void 0||e.continue()}addObserver(e){this.observers.indexOf(e)===-1&&(this.observers.push(e),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.indexOf(e)!==-1&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(e,t){var i,s,a,r,u,o;if(this.state.isFetching){if(this.state.dataUpdatedAt&&(t==null?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(this.promise)return(i=this.retryer)===null||i===void 0||i.continueRetry(),this.promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(g=>g.options.queryFn);h&&this.setOptions(h.options)}const b=ee(this.queryKey),m=B(),_={queryKey:b,pageParam:void 0,meta:this.meta};Object.defineProperty(_,"signal",{enumerable:!0,get:()=>{if(m)return this.abortSignalConsumed=!0,m.signal}});const c=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(_)):Promise.reject("Missing queryFn"),p={fetchOptions:t,options:this.options,queryKey:b,state:this.state,fetchFn:c,meta:this.meta};return!((s=this.options.behavior)===null||s===void 0)&&s.onFetch&&((a=this.options.behavior)===null||a===void 0||a.onFetch(p)),this.revertState=this.state,(!this.state.isFetching||this.state.fetchMeta!==((r=p.fetchOptions)===null||r===void 0?void 0:r.meta))&&this.dispatch({type:"fetch",meta:(u=p.fetchOptions)===null||u===void 0?void 0:u.meta}),this.retryer=new k({fn:p.fetchFn,abort:(o=m==null?void 0:m.abort)===null||o===void 0?void 0:o.bind(m),onSuccess:h=>{var g,y;this.setData(h),(y=(g=this.cache.config).onSuccess)===null||y===void 0||y.call(g,h,this),this.cacheTime===0&&this.optionalRemove()},onError:h=>{var g,y;A(h)&&h.silent||this.dispatch({type:"error",error:h}),A(h)||((y=(g=this.cache.config).onError)===null||y===void 0||y.call(g,h,this),W().error(h)),this.cacheTime===0&&this.optionalRemove()},onFail:()=>{this.dispatch({type:"failed"})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay}),this.promise=this.retryer.promise,this.promise}dispatch(e){this.state=this.reducer(this.state,e),d.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate(e)}),this.cache.notify({query:this,type:"queryUpdated",action:e})})}getDefaultState(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,s=typeof e.initialData<"u"?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0,a=typeof t<"u";return{data:t,dataUpdateCount:0,dataUpdatedAt:a?s!=null?s:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:a?"success":"idle"}}reducer(e,t){var i,s;switch(t.type){case"failed":return Object.assign(Object.assign({},e),{fetchFailureCount:e.fetchFailureCount+1});case"pause":return Object.assign(Object.assign({},e),{isPaused:!0});case"continue":return Object.assign(Object.assign({},e),{isPaused:!1});case"fetch":return Object.assign(Object.assign(Object.assign({},e),{fetchFailureCount:0,fetchMeta:(i=t.meta)!==null&&i!==void 0?i:null,isFetching:!0,isPaused:!1}),!e.dataUpdatedAt&&{error:null,status:"loading"});case"success":return Object.assign(Object.assign({},e),{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:(s=t.dataUpdatedAt)!==null&&s!==void 0?s:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":const a=t.error;return A(a)&&a.revert&&this.revertState?Object.assign({},this.revertState):Object.assign(Object.assign({},e),{error:a,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return Object.assign(Object.assign({},e),{isInvalidated:!0});case"setState":return Object.assign(Object.assign({},e),t.state);default:return e}}}class se extends L{constructor(e){super(),this.config=e||{},this.queries=[],this.queriesMap={}}build(e,t,i){var s;const a=t.queryKey,r=(s=t.queryHash)!==null&&s!==void 0?s:V(a,t);let u=this.get(r);return u||(u=new te({cache:this,queryKey:a,queryHash:r,options:e.defaultQueryOptions(t),state:i,defaultOptions:e.getQueryDefaults(a),meta:t.meta}),this.add(u)),u}add(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"queryAdded",query:e}))}remove(e){const t=this.queriesMap[e.queryHash];t&&(e.destroy(),this.queries=this.queries.filter(i=>i!==e),t===e&&delete this.queriesMap[e.queryHash],this.notify({type:"queryRemoved",query:e}))}clear(){d.batch(()=>{this.queries.forEach(e=>{this.remove(e)})})}get(e){return this.queriesMap[e]}getAll(){return this.queries}find(e,t){const[i]=P(e,t);return typeof i.exact>"u"&&(i.exact=!0),this.queries.find(s=>K(i,s))}findAll(e,t){const[i]=P(e,t);return Object.keys(i).length>0?this.queries.filter(s=>K(i,s)):this.queries}notify(e){d.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){d.batch(()=>{this.queries.forEach(e=>{e.onFocus()})})}onOnline(){d.batch(()=>{this.queries.forEach(e=>{e.onOnline()})})}}class ie{constructor(e){this.options=Object.assign(Object.assign({},e.defaultOptions),e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||ae(),this.meta=e.meta}setState(e){this.dispatch({type:"setState",state:e})}addObserver(e){this.observers.indexOf(e)===-1&&this.observers.push(e)}removeObserver(e){this.observers=this.observers.filter(t=>t!==e)}cancel(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(v).catch(v)):Promise.resolve()}continue(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()}execute(){let e;const t=this.state.status==="loading";let i=Promise.resolve();return t||(this.dispatch({type:"loading",variables:this.options.variables}),i=i.then(()=>{var s,a;(a=(s=this.mutationCache.config).onMutate)===null||a===void 0||a.call(s,this.state.variables,this)}).then(()=>{var s,a;return(a=(s=this.options).onMutate)===null||a===void 0?void 0:a.call(s,this.state.variables)}).then(s=>{s!==this.state.context&&this.dispatch({type:"loading",context:s,variables:this.state.variables})})),i.then(()=>this.executeMutation()).then(s=>{var a,r;e=s,(r=(a=this.mutationCache.config).onSuccess)===null||r===void 0||r.call(a,e,this.state.variables,this.state.context,this)}).then(()=>{var s,a;return(a=(s=this.options).onSuccess)===null||a===void 0?void 0:a.call(s,e,this.state.variables,this.state.context)}).then(()=>{var s,a;return(a=(s=this.options).onSettled)===null||a===void 0?void 0:a.call(s,e,null,this.state.variables,this.state.context)}).then(()=>(this.dispatch({type:"success",data:e}),e)).catch(s=>{var a,r;return(r=(a=this.mutationCache.config).onError)===null||r===void 0||r.call(a,s,this.state.variables,this.state.context,this),W().error(s),Promise.resolve().then(()=>{var u,o;return(o=(u=this.options).onError)===null||o===void 0?void 0:o.call(u,s,this.state.variables,this.state.context)}).then(()=>{var u,o;return(o=(u=this.options).onSettled)===null||o===void 0?void 0:o.call(u,void 0,s,this.state.variables,this.state.context)}).then(()=>{throw this.dispatch({type:"error",error:s}),s})})}executeMutation(){var e;return this.retryer=new k({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:()=>{this.dispatch({type:"failed"})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(e=this.options.retry)!==null&&e!==void 0?e:0,retryDelay:this.options.retryDelay}),this.retryer.promise}dispatch(e){this.state=re(this.state,e),d.batch(()=>{this.observers.forEach(t=>{t.onMutationUpdate(e)}),this.mutationCache.notify(this)})}}function ae(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function re(n,e){switch(e.type){case"failed":return Object.assign(Object.assign({},n),{failureCount:n.failureCount+1});case"pause":return Object.assign(Object.assign({},n),{isPaused:!0});case"continue":return Object.assign(Object.assign({},n),{isPaused:!1});case"loading":return Object.assign(Object.assign({},n),{context:e.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:e.variables});case"success":return Object.assign(Object.assign({},n),{data:e.data,error:null,status:"success",isPaused:!1});case"error":return Object.assign(Object.assign({},n),{data:void 0,error:e.error,failureCount:n.failureCount+1,isPaused:!1,status:"error"});case"setState":return Object.assign(Object.assign({},n),e.state);default:return n}}class ne extends L{constructor(e){super(),this.config=e||{},this.mutations=[],this.mutationId=0}build(e,t,i){const s=new ie({mutationCache:this,mutationId:++this.mutationId,options:e.defaultMutationOptions(t),state:i,defaultOptions:t.mutationKey?e.getMutationDefaults(t.mutationKey):void 0,meta:t.meta});return this.add(s),s}add(e){this.mutations.push(e),this.notify(e)}remove(e){this.mutations=this.mutations.filter(t=>t!==e),e.cancel(),this.notify(e)}clear(){d.batch(()=>{this.mutations.forEach(e=>{this.remove(e)})})}getAll(){return this.mutations}find(e){return typeof e.exact>"u"&&(e.exact=!0),this.mutations.find(t=>R(e,t))}findAll(e){return this.mutations.filter(t=>R(e,t))}notify(e){d.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){this.resumePausedMutations()}onOnline(){this.resumePausedMutations()}resumePausedMutations(){const e=this.mutations.filter(t=>t.state.isPaused);return d.batch(()=>e.reduce((t,i)=>t.then(()=>i.continue().catch(v)),Promise.resolve()))}}function ue(){return{onFetch:n=>{n.fetchFn=()=>{var e,t,i,s,a,r;const u=(t=(e=n.fetchOptions)===null||e===void 0?void 0:e.meta)===null||t===void 0?void 0:t.refetchPage,o=(s=(i=n.fetchOptions)===null||i===void 0?void 0:i.meta)===null||s===void 0?void 0:s.fetchMore,b=o==null?void 0:o.pageParam,m=(o==null?void 0:o.direction)==="forward",_=(o==null?void 0:o.direction)==="backward",c=((a=n.state.data)===null||a===void 0?void 0:a.pages)||[],p=((r=n.state.data)===null||r===void 0?void 0:r.pageParams)||[],h=B(),g=h==null?void 0:h.signal;let y=p,T=!1;const z=n.options.queryFn||(()=>Promise.reject("Missing queryFn")),M=(l,q,f,C)=>(y=C?[q,...y]:[...y,q],C?[f,...l]:[...l,f]),F=(l,q,f,C)=>{if(T)return Promise.reject("Cancelled");if(typeof f>"u"&&!q&&l.length)return Promise.resolve(l);const E={queryKey:n.queryKey,signal:g,pageParam:f,meta:n.meta},j=z(E),I=Promise.resolve(j).then(Q=>M(l,f,Q,C));if(H(j)){const Q=I;Q.cancel=j.cancel}return I};let O;if(!c.length)O=F([]);else if(m){const l=typeof b<"u",q=l?b:N(n.options,c);O=F(c,l,q)}else if(_){const l=typeof b<"u",q=l?b:oe(n.options,c);O=F(c,l,q,!0)}else{y=[];const l=typeof n.options.getNextPageParam>"u";O=(u&&c[0]?u(c[0],0,c):!0)?F([],l,p[0]):Promise.resolve(M([],p[0],c[0]));for(let f=1;f<c.length;f++)O=O.then(C=>{if(u&&c[f]?u(c[f],f,c):!0){const j=l?p[f]:N(n.options,C);return F(C,l,j)}return Promise.resolve(M(C,p[f],c[f]))})}const w=O.then(l=>({pages:l,pageParams:y})),J=w;return J.cancel=()=>{T=!0,h==null||h.abort(),H(O)&&O.cancel()},w}}}}function N(n,e){var t;return(t=n.getNextPageParam)===null||t===void 0?void 0:t.call(n,e[e.length-1],e)}function oe(n,e){var t;return(t=n.getPreviousPageParam)===null||t===void 0?void 0:t.call(n,e[0],e)}class he{constructor(e={}){this.queryCache=e.queryCache||new se,this.mutationCache=e.mutationCache||new ne,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}mount(){this.unsubscribeFocus=S.subscribe(()=>{S.isFocused()&&U.isOnline()&&(this.mutationCache.onFocus(),this.queryCache.onFocus())}),this.unsubscribeOnline=U.subscribe(()=>{S.isFocused()&&U.isOnline()&&(this.mutationCache.onOnline(),this.queryCache.onOnline())})}unmount(){var e,t;(e=this.unsubscribeFocus)===null||e===void 0||e.call(this),(t=this.unsubscribeOnline)===null||t===void 0||t.call(this)}isFetching(e,t){const[i]=P(e,t);return i.fetching=!0,this.queryCache.findAll(i).length}isMutating(e){return this.mutationCache.findAll(Object.assign(Object.assign({},e),{fetching:!0})).length}getQueryData(e,t){var i;return(i=this.queryCache.find(e,t))===null||i===void 0?void 0:i.state.data}getQueriesData(e){return this.getQueryCache().findAll(e).map(({queryKey:t,state:i})=>{const s=i.data;return[t,s]})}setQueryData(e,t,i){const s=x(e),a=this.defaultQueryOptions(s);return this.queryCache.build(this,a).setData(t,i)}setQueriesData(e,t,i){return d.batch(()=>this.getQueryCache().findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,i)]))}getQueryState(e,t){var i;return(i=this.queryCache.find(e,t))===null||i===void 0?void 0:i.state}removeQueries(e,t){const[i]=P(e,t),s=this.queryCache;d.batch(()=>{s.findAll(i).forEach(a=>{s.remove(a)})})}resetQueries(e,t,i){const[s,a]=P(e,t,i),r=this.queryCache,u=Object.assign(Object.assign({},s),{active:!0});return d.batch(()=>(r.findAll(s).forEach(o=>{o.reset()}),this.refetchQueries(u,a)))}cancelQueries(e,t,i){const[s,a={}]=P(e,t,i);typeof a.revert>"u"&&(a.revert=!0);const r=d.batch(()=>this.queryCache.findAll(s).map(u=>u.cancel(a)));return Promise.all(r).then(v).catch(v)}invalidateQueries(e,t,i){var s,a,r;const[u,o]=P(e,t,i),b=Object.assign(Object.assign({},u),{active:(a=(s=u.refetchActive)!==null&&s!==void 0?s:u.active)!==null&&a!==void 0?a:!0,inactive:(r=u.refetchInactive)!==null&&r!==void 0?r:!1});return d.batch(()=>(this.queryCache.findAll(u).forEach(m=>{m.invalidate()}),this.refetchQueries(b,o)))}refetchQueries(e,t,i){const[s,a]=P(e,t,i),r=d.batch(()=>this.queryCache.findAll(s).map(o=>o.fetch(void 0,Object.assign(Object.assign({},a),{meta:{refetchPage:s==null?void 0:s.refetchPage}}))));let u=Promise.all(r).then(v);return a!=null&&a.throwOnError||(u=u.catch(v)),u}fetchQuery(e,t,i){const s=x(e,t,i),a=this.defaultQueryOptions(s);typeof a.retry>"u"&&(a.retry=!1);const r=this.queryCache.build(this,a);return r.isStaleByTime(a.staleTime)?r.fetch(a):Promise.resolve(r.state.data)}prefetchQuery(e,t,i){return this.fetchQuery(e,t,i).then(v).catch(v)}fetchInfiniteQuery(e,t,i){const s=x(e,t,i);return s.behavior=ue(),this.fetchQuery(s)}prefetchInfiniteQuery(e,t,i){return this.fetchInfiniteQuery(e,t,i).then(v).catch(v)}cancelMutations(){const e=d.batch(()=>this.mutationCache.getAll().map(t=>t.cancel()));return Promise.all(e).then(v).catch(v)}resumePausedMutations(){return this.getMutationCache().resumePausedMutations()}executeMutation(e){return this.mutationCache.build(this,e).execute()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(e){this.defaultOptions=e}setQueryDefaults(e,t){const i=this.queryDefaults.find(s=>D(e)===D(s.queryKey));i?i.defaultOptions=t:this.queryDefaults.push({queryKey:e,defaultOptions:t})}getQueryDefaults(e){var t;return e?(t=this.queryDefaults.find(i=>G(e,i.queryKey)))===null||t===void 0?void 0:t.defaultOptions:void 0}setMutationDefaults(e,t){const i=this.mutationDefaults.find(s=>D(e)===D(s.mutationKey));i?i.defaultOptions=t:this.mutationDefaults.push({mutationKey:e,defaultOptions:t})}getMutationDefaults(e){var t;return e?(t=this.mutationDefaults.find(i=>G(e,i.mutationKey)))===null||t===void 0?void 0:t.defaultOptions:void 0}defaultQueryOptions(e){if(e!=null&&e._defaulted)return e;const t=Object.assign(Object.assign(Object.assign(Object.assign({},this.defaultOptions.queries),this.getQueryDefaults(e==null?void 0:e.queryKey)),e),{_defaulted:!0});return!t.queryHash&&t.queryKey&&(t.queryHash=V(t.queryKey,t)),t}defaultQueryObserverOptions(e){return this.defaultQueryOptions(e)}defaultMutationOptions(e){return e!=null&&e._defaulted?e:Object.assign(Object.assign(Object.assign(Object.assign({},this.defaultOptions.mutations),this.getMutationDefaults(e==null?void 0:e.mutationKey)),e),{_defaulted:!0})}clear(){this.queryCache.clear(),this.mutationCache.clear()}}const fe=new he({defaultOptions:{queries:{refetchOnWindowFocus:!1}}});export{ne as M,se as Q,he as a,fe as q};
